# terraform-file-organize 設定ファイル
# リソースタイプのマッチングパターンとファイル名を定義
#
# パターンマッチングの优先度（上から順にチェック）：
# 1. block_type.sub_type.name  例: "output.vpc_id.main", "resource.aws_instance.web"
# 2. block_type.sub_type       例: "output.vpc_id", "resource.aws_instance"
# 3. sub_type                  例: "vpc_id", "aws_instance"
# 4. block_type                例: "output", "resource"
#
# ワイルドカードサポート：
# - "*"      : 任意の文字列
# - "vpc_*"  : "vpc_"で始まるもの
# - "*_ip"   : "_ip"で終わるもの
# - "web*db" : "web"で始まり"db"で終わるもの
#
# exclude_files：ファイル名パターンでグループ化を除外
# - グループ化されたファイルがこのパターンにマッチする場合、個別ファイルとして保持

# グループ設定
groups:
  # AWSネットワーク関連をまとめる
  - name: "network"
    filename: "network.tf"
    patterns:
      - "aws_vpc"
      - "aws_subnet"
      - "aws_internet_gateway"
      - "aws_route_table*"
      - "aws_nat_gateway"
      - "aws_security_group*"

  # AWSコンピュート関連をまとめる
  - name: "compute"
    filename: "compute.tf"
    patterns:
      - "aws_instance"
      - "aws_launch_*"
      - "aws_autoscaling_*"
      - "aws_elb*"
      - "aws_lb*"

  # AWS RDS関連をまとめる
  - name: "database"
    filename: "database.tf"
    patterns:
      - "aws_db_*"
      - "aws_rds_*"

  # S3関連をまとめる
  - name: "storage"
    filename: "storage.tf"
    patterns:
      - "aws_s3_*"
      - "resource.aws_s3_*"       # 明示的にresourceブロック指定
  
  # 特定のリソース名で細かく分ける例
  - name: "web_infrastructure"
    filename: "web-infra.tf"
    patterns:
      - "resource.aws_instance.web*"     # webで始まるインスタンス
      - "resource.aws_lb.web*"           # webで始まるロードバランサー
      - "resource.aws_security_group.web" # 特定のwebセキュリティグループ

  # 変数、出力、ローカル値のカスタムファイル名
  - name: "variables"
    filename: "vars.tf"
    patterns:
      - "variable"
  
  # debug関連出力（これは除外されるファイル名になる）
  - name: "debug_outputs"
    filename: "debug-outputs.tf"
    patterns:
      - "output.debug_*"     # debugで始まる出力
  
  # 通常の出力
  - name: "outputs"
    filename: "outputs.tf"
    patterns:
      - "output"              # 基本的なoutputパターン
  
  - name: "locals"
    filename: "common.tf"
    patterns:
      - "locals"

# 除外ファイル（これらのファイル名にマッチするものはグループ化しない）
exclude_files:
  - "*special*"           # specialを含むファイルは個別のまま
  - "debug-*.tf"          # debug-で始まるファイルは個別のまま
  - "secret*.tf"          # secretで始まるファイルは個別のまま
  - "tmp-*.tf"            # 一時ファイルは個別のまま